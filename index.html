<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Towers of Hanoi - Terminal Edition</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        // Apply saved theme immediately to prevent flicker
        // Note: Theme colors are duplicated from game.js THEMES object
        (function() {
            const savedTheme = localStorage.getItem('hanoi_theme');
            if (savedTheme) {
                const themes = {
                    green: { bg: '#0a0a0a', text: '#00ff00', glow: '#00ff00', error: '#ff0000', win: '#ffff00', perfect: '#00ffff', bgTint: 'rgba(0, 255, 0, 0.02)' },
                    amber: { bg: '#0a0a0a', text: '#ffb000', glow: '#ffb000', error: '#ff4444', win: '#ffffff', perfect: '#ffd700', bgTint: 'rgba(255, 176, 0, 0.02)' },
                    blue: { bg: '#0a0a0a', text: '#00bfff', glow: '#00bfff', error: '#ff6b6b', win: '#ffd700', perfect: '#ff69b4', bgTint: 'rgba(0, 191, 255, 0.02)' },
                    minimal: { bg: '#1a1a1a', text: '#e0e0e0', glow: '#888888', error: '#e74c3c', win: '#f1c40f', perfect: '#3498db', bgTint: 'rgba(224, 224, 224, 0.02)' }
                };
                const colors = themes[savedTheme];
                if (colors) {
                    const root = document.documentElement;
                    root.style.setProperty('--bg-color', colors.bg);
                    root.style.setProperty('--text-color', colors.text);
                    root.style.setProperty('--text-glow', colors.glow);
                    root.style.setProperty('--error-color', colors.error);
                    root.style.setProperty('--win-color', colors.win);
                    root.style.setProperty('--perfect-color', colors.perfect);
                    root.style.setProperty('--bg-tint', colors.bgTint);
                }
            }
        })();
    </script>
</head>
<body>
    <h1>Towers of Hanoi</h1>

    <div class="header">
        <div id="timer">TIME: 00:00</div>
        <div id="moveCounter">MOVES: 0</div>
    </div>

    <div class="game-board">
        <div class="tower" data-tower="0">
            <div class="tower-label">[1/F]</div>
            <div class="pole-container">
                <div class="ascii-tower"></div>
            </div>
        </div>

        <div class="tower" data-tower="1">
            <div class="tower-label">[2/J]</div>
            <div class="pole-container">
                <div class="ascii-tower"></div>
            </div>
        </div>

        <div class="tower" data-tower="2">
            <div class="tower-label">[3/K]</div>
            <div class="pole-container">
                <div class="ascii-tower"></div>
            </div>
        </div>
    </div>

    <div class="message" id="message">Press 1/F, 2/J, or 3/K to select a tower</div>

    <div class="controls">
        <label>Disks:</label>
        <div class="disk-controls">
            <button id="decrementBtn" class="small">-</button>
            <div class="disk-count-display" id="diskCountDisplay">5</div>
            <button id="incrementBtn" class="small">+</button>
        </div>
        <button id="newGameBtn">New Game</button>
        <label>Theme:</label>
        <select id="themeSelect">
            <option value="green">Green</option>
            <option value="amber">Amber</option>
            <option value="blue">Blue</option>
            <option value="minimal">Minimal</option>
        </select>
    </div>

    <div class="high-score-section">
        <div class="high-score-header">
            <button id="toggleScoresBtn" class="small">Toggle Scores</button>
            <button id="exportScoresBtn" class="small">Export</button>
            <button id="importScoresBtn" class="small">Import</button>
            <button id="clearScoresBtn" class="small">Clear</button>
        </div>
        <div class="leaderboards-container">
            <div class="local-scores">
                <div class="leaderboard-title">YOUR SCORES</div>
                <pre id="highScoreBoard" class="high-score-board"></pre>
            </div>
            <div class="global-scores">
                <div class="leaderboard-title">GLOBAL SCORES: <span id="globalDiskCount">5</span> DISKS</div>
                <pre id="globalLeaderboard" class="high-score-board"></pre>
            </div>
        </div>
    </div>

    <!-- Name input modal for leaderboard submission -->
    <div id="nameModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-title">NEW HIGH SCORE!</div>
            <div class="modal-text">Enter your initials:</div>
            <input type="text" id="nameInput" maxlength="3" placeholder="AAA">
            <button id="submitNameBtn">Submit</button>
        </div>
    </div>

    <div class="instructions">
        Move all disks from Tower 1 to Tower 3.<br>
        Only smaller disks can be placed on larger disks.<br>
        1-2-3 or F-J-K = towers | N = new | +/- = disks | H = scores | T = theme | Esc = cancel
    </div>

    <div class="github-link">
        <a href="https://github.com/daturkel/hanoi" target="_blank">View source on GitHub</a>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.0/firebase-app.js";
        import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/11.8.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBfgaf3bNgLk20ZXdbX804UhTc8ehOxME0",
            authDomain: "hanoi-75ec9.firebaseapp.com",
            databaseURL: "https://hanoi-75ec9-default-rtdb.firebaseio.com",
            projectId: "hanoi-75ec9",
            storageBucket: "hanoi-75ec9.firebasestorage.app",
            messagingSenderId: "168656295890",
            appId: "1:168656295890:web:91534b8ebba2ff94421a0b"
        };

        const app = initializeApp(firebaseConfig);
        window.firebaseDb = getDatabase(app);
        window.firebaseRef = ref;
        window.firebaseGet = get;
        window.firebaseSet = set;
    </script>
    <script src="game.js"></script>
</body>
</html>
